<%= erb :header_partial %>

<div class="row">
  <div class="col-lg-12">
    <h1>Users <small>Administration</small></h1>
    <ol class="breadcrumb">
      <li><a href="/admin/settings"><i class="fa fa-cog"></i> Vulnreport Settings</a></li>
      <li class="active"><i class="fa fa-user"></i> Users</li>
    </ol>
  </div>
</div><!-- /.row -->

<div class="row">
  <div class="col-lg-12">
    <div style="margin: -6px 0px 10px 8px;">
      <a href="/admin/users/new"><i class="fa fa-plus"></i> Manually Add New User</a>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-user"></i> Admin Users</h3>
      </div>
      <div class="panel-body">
        <table class="table table-striped">
          <tr>
            <td style="width:10%"><b>Status</b></td>
            <td style="width:25%"><b>Name</b></td>
            <td style="width:20%"><b>Org</b></td>
            <td style="width:25%"><b>Email</b></td>
            <td style="width:20%"><b>Last Login</b></td>
          </tr>

          <% @adminUsers.each do |u| %>
          <tr>
            <td style="width:10%"><%=u[:status]%></td>
            <td style="width:25%"><a href="/admin/users/<%=u[:uid]%>"><% if(u[:name].nil? || u[:name].empty?)%>UNSUB<%else%> <%=h(u[:name])%> <%end%></a></td>
            <td style="width:20%"><a href="/admin/orgs/<%=u[:oid]%>"><%=h(u[:org])%></a></td>
            <td style="width:25%"><%=h(u[:email])%></td>
            <td style="width:20%"><% if !u[:lastLogin].nil? %><%=u[:lastLogin]%><% end %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-user"></i> Active Users</h3>
      </div>
      <div class="panel-body">
        <table class="table table-striped">
          <tr>
            <td style="width:10%"><b>Status</b></td>
            <td style="width:25%"><b>Name</b></td>
            <td style="width:20%"><b>Org</b></td>
            <td style="width:25%"><b>Email</b></td>
            <td style="width:20%"><b>Last Login</b></td>
          </tr>

          <% @activeUsers.each do |u| %>
          <tr>
            <td style="width:10%"><%=u[:status]%></td>
            <td style="width:25%"><a href="/admin/users/<%=u[:uid]%>"><% if(u[:name].nil? || u[:name].empty?)%>UNSUB<%else%> <%=h(u[:name])%> <%end%></a></td>
            <td style="width:20%"><a href="/admin/orgs/<%=u[:oid]%>"><%=h(u[:org])%></a></td>
            <td style="width:25%"><%=h(u[:email])%></td>
            <td style="width:20%"><% if !u[:lastLogin].nil? %><%=u[:lastLogin]%><% end %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-user"></i> Contractor Users</h3>
      </div>
      <div class="panel-body">
        <table class="table table-striped">
          <tr>
            <td style="width:10%"><b>Status</b></td>
            <td style="width:25%"><b>Name</b></td>
            <td style="width:20%"><b>Org</b></td>
            <td style="width:25%"><b>Email</b></td>
            <td style="width:20%"><b>Last Login</b></td>
          </tr>

          <% @conUsers.each do |u| %>
          <tr>
            <td style="width:10%"><%=u[:status]%></td>
            <td style="width:25%"><a href="/admin/users/<%=u[:uid]%>"><% if(u[:name].nil? || u[:name].empty?)%>UNSUB<%else%> <%=h(u[:name])%> <%end%></a></td>
            <td style="width:20%"><a href="/admin/orgs/<%=u[:oid]%>"><%=h(u[:org])%></a></td>
            <td style="width:25%"><%=h(u[:email])%></td>
            <td style="width:20%"><% if !u[:lastLogin].nil? %><%=u[:lastLogin]%><% end %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-user"></i> Reports-Only Users</h3>
      </div>
      <div class="panel-body">
        <table class="table table-striped">
          <tr>
            <td style="width:10%"><b>Status</b></td>
            <td style="width:25%"><b>Name</b></td>
            <td style="width:20%"><b>Org</b></td>
            <td style="width:25%"><b>Email</b></td>
            <td style="width:20%"><b>Last Login</b></td>
          </tr>

          <% @roUsers.each do |u| %>
          <tr>
            <td style="width:10%"><%=u[:status]%></td>
            <td style="width:25%"><a href="/admin/users/<%=u[:uid]%>"><% if(u[:name].nil? || u[:name].empty?)%>UNSUB<%else%> <%=h(u[:name])%> <%end%></a></td>
            <td style="width:20%"><a href="/admin/orgs/<%=u[:oid]%>"><%=h(u[:org])%></a></td>
            <td style="width:25%"><%=h(u[:email])%></td>
            <td style="width:20%"><% if !u[:lastLogin].nil? %><%=u[:lastLogin]%><% end %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-user"></i> Awaiting Verification</h3>
      </div>
      <div class="panel-body">
        <table class="table table-striped">
          <tr>
            <td style="width:10%"><b>Status</b></td>
            <td style="width:25%"><b>Name</b></td>
            <td style="width:20%"><b>Org</b></td>
            <td style="width:25%"><b>Email</b></td>
            <td style="width:20%"><b>Last Login</b></td>
          </tr>

          <% @unverified.each do |u| %>
          <tr>
            <td style="width:10%"><%=u[:status]%></td>
            <td style="width:20%"><a href="/admin/users/<%=u[:uid]%>"><% if(u[:name].nil? || u[:name].empty?)%>UNSUB<%else%> <%=h(u[:name])%> <%end%></a></td>
            <td style="width:20%"><a href="/admin/orgs/<%=u[:oid]%>"><%=h(u[:org])%></a></td>
            <td style="width:25%"><%=h(u[:email])%></td>
            <td style="width:20%"><% if !u[:lastLogin].nil? %><%=u[:lastLogin]%><% end %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-user"></i> Inactive Users</h3>
      </div>
      <div class="panel-body">
        <table class="table table-striped">
          <tr>
            <td style="width:10%"><b>Status</b></td>
            <td style="width:25%"><b>Name</b></td>
            <td style="width:20%"><b>Org</b></td>
            <td style="width:25%"><b>Email</b></td>
            <td style="width:20%"><b>Last Login</b></td>
          </tr>

          <% @inactive.each do |u| %>
          <tr>
            <td style="width:10%"><%=u[:status]%></td>
            <td style="width:25%"><a href="/admin/users/<%=u[:uid]%>"><% if(u[:name].nil? || u[:name].empty?)%>UNSUB<%else%> <%=h(u[:name])%> <%end%></a></td>
            <td style="width:20%"><a href="/admin/orgs/<%=u[:oid]%>"><%=h(u[:org])%></a></td>
            <td style="width:25%"><%=h(u[:email])%></td>
            <td style="width:20%"><% if !u[:lastLogin].nil? %><%=u[:lastLogin]%><% end %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<%= erb :footer_partial %>